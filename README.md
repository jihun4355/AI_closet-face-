# 👕 AI Emotion-Based Clothing Recommendation System  
**AI 얼굴 감정 인식 + 의류 추천 알고리즘 통합 프로젝트**

본 프로젝트는 **CNN 기반 감정 인식 모델**과  
기존 ONNX 기반 의류 분류 모델을 결합하여,  
사용자의 표정 → 감정 분석 → 감정에 맞는 의류 추천까지  
**완전 자동화한 AI 패션 추천 시스템**입니다.

👉 **전체 PDF 문서 보기**  
[📄 AI_closet_face.pdf](./AI_closet_face.pdf)

:contentReference[oaicite:1]{index=1}

---

## 📌 1. 프로젝트 개요

### 💡 프로젝트 목표 (p.1)
- 실시간 표정 인식 → 감정 분류(CNN 모델)  
- 감정 결과를 기반으로 옷 스타일 자동 추천  
- ONNX 기반 옷 분류 모델과 연동  
- 사용자 친화적 UI(Tkinter)로 결과 시각화  
- 추천 결과를 이미지 & 텍스트로 명확히 표시  

### 👨‍💻 팀원 역할 (p.1)
| 팀원 | 역할 |
|------|------|
| 팀원 A | 감정 인식 모델 학습 및 병합 |
| 팀원 B | ONNX 기반 의류 감지, 실시간 영상 처리 |
| 팀원 C | 감정-의류 추천 매핑, UI 개발 |

---

## 🏗 2. 기능 블록도 (PDF p.2)
카메라 모듈
↓ (얼굴/의류 이미지 촬영)
ONNX 의류 분류 ───────────→ 의류 상세 분류
↓ ↓
감정 인식 CNN 모델 → 감정 예측
↓
감정 기반 의류 추천 알고리즘
↓
디스플레이 출력(UI)



---

## ⚙ 3. 설계 제한 요소 (p.3)

PDF에 명시된 설계 제약사항 요약:

| 항목 | 설명 |
|------|------|
| 경제성 | 일반 PC 환경에서 실행하여 비용 절감 |
| 안전성 | 사용자 정보 저장 X, UI 단순화 |
| 신뢰성 | 감정 인식 결과는 5초 평균값으로 처리 |
| 미관 | 터치 UI 기반의 큰 버튼 및 가독성 높은 텍스트 |
| 윤리성 | 감정을 판단 목적이 아닌 "추천" 용도로만 사용 |
| 사회적 영향 | 고령자·어린이도 쉽게 사용할 수 있는 UI |
| 기능성 | 실시간 감정 분석 + 추천 옷 필터링 + UI 통합 |

---

## 🛠 4. 사용 기술 (p.3)

| 구분 | 기술 | 사용 목적 |
|------|------|-----------|
| Python 3.12 | 전체 시스템 개발 |
| PyTorch | CNN 감정 인식 모델 실행 |
| ONNXRuntime | 의류 분류 모델 추론 |
| OpenCV | 웹캠 입력 및 전처리 |
| Tkinter | 감정 UI & 추천 결과 표시 |
| 웹캠 | 얼굴 촬영 |
| 터치 모니터 | 감정/추천 결과 보기 |

---

# 📚 5. 상세 알고리즘 설명

---

## 🎭 A. CNN 감정 인식 모델 (p.4~7)

### ✔ 감정 클래스
- angry  
- sad  
- happy  
- default(무표정)

### ✔ 데이터셋 구성
- 구글 이미지 크롤링  
- 직접 촬영한 표정  
- 다양한 augmentation 적용  
  - 회전, 색상/채도 변화, Blur, Noise 등

### ✔ 학습 모델
- **ResNet18 기반** (ImageNet pretrained)  
- 마지막 FC 레이어 수정  
- Epoch 10 기준 train_loss/val_loss 감소 & 정확도 증가 (PDF 그래프 참고)

### ✔ 실시간 감정 분석 흐름


1. 5초 동안 프레임 수집  
2. 각 프레임마다 CNN 예측  
3. 가장 많은 감정을 최종 감정으로 선택  
4. UI에 막대 그래프 + 퍼센트 표시  

---

## 🧥 B. 감정 기반 의류 추천 알고리즘 (p.6~8)

### ✔ 가능한 의류 종류
출처: PDF 6페이지 표  :contentReference[oaicite:2]{index=2}

**상의**  
- 셔츠  
- 스웨터/니트  
- 맨투맨/후드티  
- 반팔 티셔츠  

**하의**  
- 청바지  
- 반바지  
- 슬랙스/면바지  
- 스웨트 팬츠  
- 카고  

**아우터**  
- 점퍼  
- 패딩  
- 바람막이  
- 코트  
- 후리스  
- 자켓  
- 없음  

### ✔ 추천 방식
- emotion 컬럼(happy/sad/angry/default)과 일치하는 행 필터링  
- 상의 1개 + 하의 1개 랜덤 추천  
- in_stock == TRUE 여부 검사  
- 이미지 파일을 Tkinter로 팝업 표시  

### ✔ 추천 예시 (p.6~10)
- angry → 검정 가죽 자켓 + 검정 팬츠  
- happy → 파랑 셔츠 + 연청 데님 팬츠  
- sad → 진청 셔츠 + 회색 조거 팬츠  

---

# 🖥 6. UI 구성(Tkinter 기반) (p.21~24)

UI 흐름:

### ✔ 메인 화면
- 720×580 카메라 캔버스  
- "감정 인식" 버튼  
- 감정별 확률 bar graph  
- 인식된 감정 결과 표시  

### ✔ 감정 분석 후
- 감정 Pie Chart 생성  
- 추천 옷 상의/하의 이미지 팝업  
- 결과 분석 버튼 활성화  

### ✔ UI 코드 흐름 (emotionUI.py)
- update(): 1ms마다 카메라 프레임 처리  
- start_recognize(): 5초 동안 감정 수집  
- detect_emotion(): CNN 추론  
- show_pie_chart(): 추천 알고리즘 실행  

---

# 🧩 7. 전체 코드 구조 (PDF p.16~27)
emotionRecognizer.py # 감정 CNN 모델 로딩 및 추론
clothes_recommend.py # 감정 기반 옷 추천 알고리즘
emotionUI.py # Tkinter UI + 카메라 + 추천 시스템 통합
webcam.py # OpenCV 기반 카메라 처리
func.py # CSV 유틸리티
best_model2.pth # 감정 인식 모델 가중치
clothes_data.csv # 의류 데이터셋
clothes_style/ # 의류 이미지 폴더


---

# 🧪 8. 테스트 결과 (p.8~10)
- 다양한 감정에서 높은 정확도로 감정 인식  
- 감정별 추천 결과 유의미하게 다르게 출력  
- Pie Chart 구성으로 감정 비율 시각화  
- UI의 만족도 및 정확도 개선  

---

# ⭐ 9. 제작 후 자체 평가(요약) (p.11~12)

- 감정이라는 주관적 요소를 기술적으로 다루는 것이 어려웠음  
- 모델 학습 및 데이터 전처리의 중요성 체감  
- 감정-의류라는 이질적인 요소 결합이 창의적 경험  
- 사용자 경험 UI 설계의 중요성 재확인  
- 기존 프로젝트 활용해 확장 개발 가능성 확인  

---


---

# 🎉 결론

AI Closet Face 프로젝트는  
**실시간 감정 인식 + 의류 추천 알고리즘 + 직관적 UI**를 완전히 통합한  
딥러닝 기반 AI 응용 프로젝트입니다.

---



